<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>{{ title or "AgroMath" }}</title>
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>

<nav class="topbar">
  <div class="brand">AgroMath</div>

  <div class="nav-actions">
    <button id="themeToggle" class="nav-btn">ðŸŒ— Theme</button>
    <button id="soundToggle" class="nav-btn">ðŸ”” Sound</button>
    <a href="/profile" class="nav-link">Profile</a>
    <a href="/logout" class="nav-link">Logout</a>
  </div>
</nav>

<main class="container">
  {% block content %}{% endblock %}
</main>

<audio id="notifySound" preload="auto">
  <source src="/static/notify.wav" type="audio/wav">
</audio>

<script>
  // ---------- THEME ----------
  const root = document.documentElement;
  const themeBtn = document.getElementById("themeToggle");

  let theme = localStorage.getItem("theme") || "light";
  root.setAttribute("data-theme", theme);

  themeBtn.onclick = () => {
    theme = theme === "light" ? "dark" : "light";
    root.setAttribute("data-theme", theme);
    localStorage.setItem("theme", theme);
  };

  // ---------- SOUND ----------
  const soundBtn = document.getElementById("soundToggle");
  const bell = document.getElementById("notifySound");

  let soundEnabled = localStorage.getItem("sound") === "on";

  function updateSoundBtn() {
    soundBtn.textContent = soundEnabled ? "ðŸ”” Sound On" : "ðŸ”• Sound Off";
  }

  updateSoundBtn();

  soundBtn.onclick = () => {
    soundEnabled = !soundEnabled;
    localStorage.setItem("sound", soundEnabled ? "on" : "off");

    if (soundEnabled) {
      bell.play().catch(()=>{}); // unlock audio
    }

    updateSoundBtn();
