{% extends "base.html" %}
{% block content %}

<div class="row space">
  <div>
    <h2>Farmer Dashboard</h2>
    <div class="muted">List products and monitor orders that contain your items.</div>
  </div>
  <div class="pillrow">
    <a class="btn btn-ghost" href="/orders">Orders</a>
    <a class="btn btn-light" href="/profile">Profile</a>
  </div>
</div>

<div class="grid2">
  <div class="card">
    <h3>Add product</h3>
    <form method="post" action="/farmer/product/add" class="stack">
      <input name="name" placeholder="e.g., Yam" required>
      <input name="unit" placeholder="unit (e.g., tuber, bag, kg)" value="unit" required>
      <input name="price" type="number" min="1" placeholder="Price (NGN)" required>
      <button class="btn btn-primary" type="submit">Add</button>
    </form>

    <div class="spacer"></div>
    <h3>Your products</h3>
    {% if products %}
      <div class="table">
        <div class="thead">
          <div>Name</div><div>Unit</div><div>Price</div><div>Status</div><div></div>
        </div>
        {% for p in products %}
          <div class="trow">
            <div class="strong">{{ p.name }}</div>
            <div class="muted">{{ p.unit }}</div>
            <div><b>{{ money(p.price) }}</b></div>
            <div class="muted small">{{ "Active" if p.is_active else "Hidden" }}</div>
            <div>
              <form method="post" action="/farmer/product/toggle" class="inline">
                <input type="hidden" name="product_id" value="{{ p.id }}">
                <button class="btn btn-light" type="submit">{{ "Hide" if p.is_active else "Show" }}</button>
              </form>
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <p class="muted">No products yet.</p>
    {% endif %}
  </div>

  <div class="card">
    <h3>Recent orders containing your products</h3>
    {% if orders %}
      <div class="orders">
        {% for o in orders %}
          <div class="order-card">
            <div class="row">
              <div>
                <div class="strong">{{ o.id }}</div>
                <div class="muted small">{{ o.origin }} → {{ o.dest }} · {{ o.created_at }}</div>
              </div>
              <div class="status">{{ o.status }}</div>
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <p class="muted">No orders yet.</p>
    {% endif %}
  </div>
</div>

{% endblock %}
